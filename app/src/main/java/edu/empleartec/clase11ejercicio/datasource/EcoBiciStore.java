package edu.empleartec.clase11ejercicio.datasource;

import android.content.Context;
import android.location.Location;
import android.util.Log;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import org.json.XML;

import java.util.ArrayList;
import java.util.List;

import edu.empleartec.clase11ejercicio.model.Station;

/**
 * Created by gcalero
 */
public class EcoBiciStore {

    private static final String TAG = "EcoBiciStore";
    private static EcoBiciStore instance;

    public static EcoBiciStore getInstance() {
        if (instance == null) {
            instance = new EcoBiciStore();
        }
        return instance;
    }

    public List<Station> getAllStations(Context context) {
        String xml = getXml(context);
        JSONObject json = convertXmlToJson(xml);

        List<Station> stations = new ArrayList<>();
        if (json != null && json.has("soap:Envelope")) {
            Log.d(TAG, json.toString());
            // {"soap:Envelope":{"soap:Body":{"BicicletasWSResponse":{"BicicletasWSResult":{"Bicicletas":{"Estaciones":{"Estacion":[{"AnclajesTotales":18,"Numero":2260,"Latitud":-34.583271,"Piso":"","Lugar":"Figueroa Alcorta y Pueyrredón","EstacionDisponible":"SI","AnclajesDisponibles":18,"BicicletaDisponibles":0,"Longitud":-58.392579,"EstacionNombre":"Facultad de Derecho","EstacionId":1}]}}}}
            JSONObject soapEnvelope = json.optJSONObject("soap:Envelope");
            if (soapEnvelope.has("soap:Body")) {
                JSONObject soapBody = soapEnvelope.optJSONObject("soap:Body");
                if (soapBody.has("BicicletasWSResponse")) {
                    JSONObject bicicletasWSResponse = soapBody.optJSONObject("BicicletasWSResponse");
                    if (bicicletasWSResponse.has("BicicletasWSResult")) {
                        JSONObject bicicletasResult = bicicletasWSResponse.optJSONObject("BicicletasWSResult");
                        if (bicicletasResult.has("Bicicletas")) {
                            JSONObject bicicletas = bicicletasResult.optJSONObject("Bicicletas");
                            if (bicicletas.has("Estaciones")) {
                                JSONObject estaciones = bicicletas.optJSONObject("Estaciones");
                                if (estaciones.has("Estacion")) {
                                    JSONArray estacion = estaciones.optJSONArray("Estacion");
                                    for (int i = 0; i < estacion.length(); i++) {
                                        JSONObject unaEstacion = estacion.optJSONObject(i);
                                        Station station = new Station();
                                        station.id = unaEstacion.optLong("EstacionNombre");
                                        station.name = unaEstacion.optString("EstacionNombre");
                                        station.totalSlots = unaEstacion.optInt("AnclajesTotales");
                                        station.freeSlots = unaEstacion.optInt("AnclajesDisponibles");
                                        station.number = unaEstacion.optInt("Numero");
                                        station.location = new Location("ws");
                                        station.location.setLatitude(unaEstacion.optDouble("Latitud"));
                                        station.location.setLongitude(unaEstacion.optDouble("Longitud"));
                                        station.locationText = unaEstacion.optString("Lugar");
                                        station.available = "SI".equals(unaEstacion.optString("EstacionDisponible", "NO"));
                                        station.availableBikes = unaEstacion.optInt("BicicletaDisponibles");
                                        stations.add(station);
                                    }

                                }
                            }

                        }
                    }
                }
            }
        }

        return stations;
    }


    private String getXml(Context context) {
        // TODO: obtener esta info de https://recursos-data.buenosaires.gob.ar/ckan2/ecobici/estado-ecobici.xml
        return "<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"><soap:Body><BicicletasWSResponse xmlns=\"http://tempuri.org/\"><BicicletasWSResult><Bicicletas xmlns=\"http://bicis.buenosaires.gob.ar/ServiceBicycle.asmx\"><Estaciones><Estacion><EstacionId>1</EstacionId><EstacionNombre>Facultad de Derecho</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.583271</Latitud><Longitud>-58.392579</Longitud><Numero>2260</Numero><Lugar>Figueroa Alcorta y Pueyrredón</Lugar><Piso></Piso><AnclajesTotales>18</AnclajesTotales><AnclajesDisponibles>18</AnclajesDisponibles></Estacion><Estacion><EstacionId>2</EstacionId><EstacionNombre>Retiro</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.592966</Latitud><Longitud>-58.374379</Longitud><Numero>0</Numero><Lugar>Libertador altura Retiro</Lugar><Piso></Piso><AnclajesTotales>16</AnclajesTotales><AnclajesDisponibles>15</AnclajesDisponibles></Estacion><Estacion><EstacionId>3</EstacionId><EstacionNombre>Aduana</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.611376</Latitud><Longitud>-58.369009</Longitud><Numero>0</Numero><Lugar>Moreno y Paseo Colón</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>4</EstacionId><EstacionNombre>Plaza Roma</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.601714</Latitud><Longitud>-58.369202</Longitud><Numero>0</Numero><Lugar>Lavalle y Bouchard </Lugar><Piso></Piso><AnclajesTotales>10</AnclajesTotales><AnclajesDisponibles>10</AnclajesDisponibles></Estacion><Estacion><EstacionId>5</EstacionId><EstacionNombre>Plaza Italia</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.580563</Latitud><Longitud>-58.420605</Longitud><Numero>2601</Numero><Lugar>Plaza Italia</Lugar><Piso></Piso><AnclajesTotales>28</AnclajesTotales><AnclajesDisponibles>28</AnclajesDisponibles></Estacion><Estacion><EstacionId>6</EstacionId><EstacionNombre>Parque Lezama</EstacionNombre><BicicletaDisponibles>3</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.628233</Latitud><Longitud>-58.369606</Longitud><Numero>0</Numero><Lugar>Martín García e Irala</Lugar><Piso></Piso><AnclajesTotales>15</AnclajesTotales><AnclajesDisponibles>12</AnclajesDisponibles></Estacion><Estacion><EstacionId>7</EstacionId><EstacionNombre>Obelisco </EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.605997</Latitud><Longitud>-58.38098 </Longitud><Numero>200</Numero><Lugar>Perón y Carlos Pellegrini</Lugar><Piso></Piso><AnclajesTotales>16</AnclajesTotales><AnclajesDisponibles>16</AnclajesDisponibles></Estacion><Estacion><EstacionId>8</EstacionId><EstacionNombre>Congreso</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.609733</Latitud><Longitud>-58.389253</Longitud><Numero>0</Numero><Lugar>Virrey Cevallos e Hipólito Yrigoyen</Lugar><Piso></Piso><AnclajesTotales>26</AnclajesTotales><AnclajesDisponibles>25</AnclajesDisponibles></Estacion><Estacion><EstacionId>9</EstacionId><EstacionNombre>Parque Las Heras</EstacionNombre><BicicletaDisponibles>2</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.585744</Latitud><Longitud>-58.408005</Longitud><Numero>0</Numero><Lugar>Coronel Díaz y French</Lugar><Piso></Piso><AnclajesTotales>28</AnclajesTotales><AnclajesDisponibles>26</AnclajesDisponibles></Estacion><Estacion><EstacionId>10</EstacionId><EstacionNombre>Madero UCA</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.616106</Latitud><Longitud>-58.366017</Longitud><Numero>0</Numero><Lugar>Alicia Moreau de Justo altura Independencia</Lugar><Piso></Piso><AnclajesTotales>19</AnclajesTotales><AnclajesDisponibles>18</AnclajesDisponibles></Estacion><Estacion><EstacionId>11</EstacionId><EstacionNombre>Tribunales</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.601343</Latitud><Longitud>-58.385250</Longitud><Numero>0</Numero><Lugar>Talcahuano y Tucumán</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>12</EstacionId><EstacionNombre>Plaza Vicente López</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.592583</Latitud><Longitud>-58.388965</Longitud><Numero>0</Numero><Lugar>Paraná y Juncal</Lugar><Piso></Piso><AnclajesTotales>10</AnclajesTotales><AnclajesDisponibles>10</AnclajesDisponibles></Estacion><Estacion><EstacionId>13</EstacionId><EstacionNombre>Once</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.609881</Latitud><Longitud>-58.406346</Longitud><Numero>0</Numero><Lugar>Pueyrredón y Rivadavia</Lugar><Piso></Piso><AnclajesTotales>26</AnclajesTotales><AnclajesDisponibles>25</AnclajesDisponibles></Estacion><Estacion><EstacionId>14</EstacionId><EstacionNombre>Pacífico</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.578112</Latitud><Longitud>-58.426416</Longitud><Numero>0</Numero><Lugar>Santa Fe y Bullrich</Lugar><Piso></Piso><AnclajesTotales>21</AnclajesTotales><AnclajesDisponibles>21</AnclajesDisponibles></Estacion><Estacion><EstacionId>16</EstacionId><EstacionNombre>Legislatura</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.610158</Latitud><Longitud>-58.374814</Longitud><Numero>0</Numero><Lugar>Perú y Diagonal Sur</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>17</EstacionId><EstacionNombre>Plaza Almagro</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.606463</Latitud><Longitud>-58.418705</Longitud><Numero>0</Numero><Lugar>Bulnes y Perón</Lugar><Piso></Piso><AnclajesTotales>19</AnclajesTotales><AnclajesDisponibles>19</AnclajesDisponibles></Estacion><Estacion><EstacionId>18</EstacionId><EstacionNombre>Independencia</EstacionNombre><BicicletaDisponibles>3</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.617690</Latitud><Longitud>-58.380473</Longitud><Numero>0</Numero><Lugar>Independencia y Bernardo de Irigoyen</Lugar><Piso></Piso><AnclajesTotales>14</AnclajesTotales><AnclajesDisponibles>11</AnclajesDisponibles></Estacion><Estacion><EstacionId>19</EstacionId><EstacionNombre>Plaza San Martín</EstacionNombre><BicicletaDisponibles>2</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.595593</Latitud><Longitud>-58.376986</Longitud><Numero>750</Numero><Lugar>Santa Fe y Maipú</Lugar><Piso></Piso><AnclajesTotales>26</AnclajesTotales><AnclajesDisponibles>24</AnclajesDisponibles></Estacion><Estacion><EstacionId>20</EstacionId><EstacionNombre>Distrito Audiovisual</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.579996</Latitud><Longitud>-58.441615</Longitud><Numero>0</Numero><Lugar>Dorrego y Zapiola</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>21</EstacionId><EstacionNombre>Parque Patricios</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.640112</Latitud><Longitud>-58.406552</Longitud><Numero>0</Numero><Lugar>Iguazú y Uspallata</Lugar><Piso></Piso><AnclajesTotales>28</AnclajesTotales><AnclajesDisponibles>27</AnclajesDisponibles></Estacion><Estacion><EstacionId>22</EstacionId><EstacionNombre>Arenales</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.594087</Latitud><Longitud>-58.382662</Longitud><Numero>0</Numero><Lugar>Arenales y Cerrito</Lugar><Piso></Piso><AnclajesTotales>12</AnclajesTotales><AnclajesDisponibles>12</AnclajesDisponibles></Estacion><Estacion><EstacionId>23</EstacionId><EstacionNombre>Suipacha</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.600140</Latitud><Longitud>-58.379679</Longitud><Numero>0</Numero><Lugar>Suipacha y Viamonte</Lugar><Piso></Piso><AnclajesTotales>10</AnclajesTotales><AnclajesDisponibles>10</AnclajesDisponibles></Estacion><Estacion><EstacionId>24</EstacionId><EstacionNombre>Alsina</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.610656</Latitud><Longitud>-58.380845</Longitud><Numero>0</Numero><Lugar>Alsina y Bernardo de Irigoyen</Lugar><Piso></Piso><AnclajesTotales>14</AnclajesTotales><AnclajesDisponibles>14</AnclajesDisponibles></Estacion><Estacion><EstacionId>25</EstacionId><EstacionNombre>Plaza Güemes</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.589340</Latitud><Longitud>-58.416322</Longitud><Numero>0</Numero><Lugar>Salguero y Mansilla</Lugar><Piso></Piso><AnclajesTotales>21</AnclajesTotales><AnclajesDisponibles>21</AnclajesDisponibles></Estacion><Estacion><EstacionId>26</EstacionId><EstacionNombre>Juana Manso</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.600525</Latitud><Longitud>-58.363645</Longitud><Numero>0</Numero><Lugar>Juana Manso y Emma de la Barra</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>27</EstacionId><EstacionNombre>Montevideo</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.599506</Latitud><Longitud>-58.389902</Longitud><Numero>1616</Numero><Lugar>Córdoba y Montevideo</Lugar><Piso></Piso><AnclajesTotales>15</AnclajesTotales><AnclajesDisponibles>14</AnclajesDisponibles></Estacion><Estacion><EstacionId>28</EstacionId><EstacionNombre>Plaza Boedo</EstacionNombre><BicicletaDisponibles>2</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.622995</Latitud><Longitud>-58.41258 </Longitud><Numero>0</Numero><Lugar>Carlos Calvo y Sanchez de Loria</Lugar><Piso></Piso><AnclajesTotales>17</AnclajesTotales><AnclajesDisponibles>15</AnclajesDisponibles></Estacion><Estacion><EstacionId>29</EstacionId><EstacionNombre>Parque Centenario </EstacionNombre><BicicletaDisponibles>9</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.607873</Latitud><Longitud>-58.433540</Longitud><Numero>0</Numero><Lugar>Patricias Argentinas y Estivao</Lugar><Piso></Piso><AnclajesTotales>25</AnclajesTotales><AnclajesDisponibles>16</AnclajesDisponibles></Estacion><Estacion><EstacionId>30</EstacionId><EstacionNombre>Peña</EstacionNombre><BicicletaDisponibles>2</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.590586</Latitud><Longitud>-58.397434</Longitud><Numero>0</Numero><Lugar>Peña y Azcuénaga</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>18</AnclajesDisponibles></Estacion><Estacion><EstacionId>31</EstacionId><EstacionNombre>Padilla</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.603173</Latitud><Longitud>-58.439635</Longitud><Numero>0</Numero><Lugar>Padilla y Julián Alvarez</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>19</AnclajesDisponibles></Estacion><Estacion><EstacionId>32</EstacionId><EstacionNombre>Catedral</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.607559</Latitud><Longitud>-58.373600</Longitud><Numero>0</Numero><Lugar>San Martín y Rivadavia</Lugar><Piso></Piso><AnclajesTotales>3</AnclajesTotales><AnclajesDisponibles>3</AnclajesDisponibles></Estacion><Estacion><EstacionId>33</EstacionId><EstacionNombre>Facultad de Medicina</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.597211</Latitud><Longitud>-58.398887</Longitud><Numero>0</Numero><Lugar>Uriburu y M. T. de Alvear</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>34</EstacionId><EstacionNombre>Galerías Pacífico</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.599097</Latitud><Longitud>-58.37416 </Longitud><Numero>0</Numero><Lugar>San Martín y Viamonte</Lugar><Piso></Piso><AnclajesTotales>15</AnclajesTotales><AnclajesDisponibles>15</AnclajesDisponibles></Estacion><Estacion><EstacionId>35</EstacionId><EstacionNombre>Ingeniero Butty</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.596146</Latitud><Longitud>-58.371839</Longitud><Numero>0</Numero><Lugar>Ingeniero Butty y Leando N. Alem</Lugar><Piso></Piso><AnclajesTotales>26</AnclajesTotales><AnclajesDisponibles>26</AnclajesDisponibles></Estacion><Estacion><EstacionId>36</EstacionId><EstacionNombre>Maipú</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.604841</Latitud><Longitud>-58.376584</Longitud><Numero>0</Numero><Lugar>Maipú y Sarmiento</Lugar><Piso></Piso><AnclajesTotales>16</AnclajesTotales><AnclajesDisponibles>16</AnclajesDisponibles></Estacion><Estacion><EstacionId>37</EstacionId><EstacionNombre>Piedras</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.607948</Latitud><Longitud>-58.377993</Longitud><Numero>0</Numero><Lugar>Esmeralda y Rivadavia</Lugar><Piso></Piso><AnclajesTotales>8</AnclajesTotales><AnclajesDisponibles>8</AnclajesDisponibles></Estacion><Estacion><EstacionId>38</EstacionId><EstacionNombre>Plaza Libertad</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.596969</Latitud><Longitud>-58.382798</Longitud><Numero>0</Numero><Lugar>Cerrito y M. T. de Alvear</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>19</AnclajesDisponibles></Estacion><Estacion><EstacionId>40</EstacionId><EstacionNombre>Sarmiento</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.604436</Latitud><Longitud>-58.373785</Longitud><Numero>0</Numero><Lugar>Sarmiento y San Martín</Lugar><Piso></Piso><AnclajesTotales>18</AnclajesTotales><AnclajesDisponibles>17</AnclajesDisponibles></Estacion><Estacion><EstacionId>41</EstacionId><EstacionNombre>Urquiza</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.636356</Latitud><Longitud>-58.40766 </Longitud><Numero>0</Numero><Lugar>Urquiza y Rondeau</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>19</AnclajesDisponibles></Estacion><Estacion><EstacionId>42</EstacionId><EstacionNombre>Diagonal Norte</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.604720</Latitud><Longitud>-58.37967 </Longitud><Numero>0</Numero><Lugar>Pres. Roque Saenz Peña entre Suipacha y Carlos Pellegrini</Lugar><Piso></Piso><AnclajesTotales>18</AnclajesTotales><AnclajesDisponibles>18</AnclajesDisponibles></Estacion><Estacion><EstacionId>43</EstacionId><EstacionNombre>Plaza Houssay</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.599755</Latitud><Longitud>-58.397834</Longitud><Numero>2135</Numero><Lugar>Córdoba entre Junín y Pres. E. José Uriburu</Lugar><Piso></Piso><AnclajesTotales>27</AnclajesTotales><AnclajesDisponibles>27</AnclajesDisponibles></Estacion><Estacion><EstacionId>44</EstacionId><EstacionNombre>Zoológico</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.575548</Latitud><Longitud>-58.413716</Longitud><Numero>3300</Numero><Lugar>Del Libertador 3300 entre Sarmiento y Adolfo Berro</Lugar><Piso></Piso><AnclajesTotales>18</AnclajesTotales><AnclajesDisponibles>17</AnclajesDisponibles></Estacion><Estacion><EstacionId>46</EstacionId><EstacionNombre>Chile</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.616327</Latitud><Longitud>-58.374491</Longitud><Numero>726</Numero><Lugar>Chile y Perú</Lugar><Piso></Piso><AnclajesTotales>18</AnclajesTotales><AnclajesDisponibles>18</AnclajesDisponibles></Estacion><Estacion><EstacionId>48</EstacionId><EstacionNombre>Perón</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.605429</Latitud><Longitud>-58.371528</Longitud><Numero>339</Numero><Lugar>Tte. Gral. Juan Domingo Perón entre 25 De Mayo y Reconquista</Lugar><Piso></Piso><AnclajesTotales>13</AnclajesTotales><AnclajesDisponibles>13</AnclajesDisponibles></Estacion><Estacion><EstacionId>51</EstacionId><EstacionNombre>Tucumán</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.601347</Latitud><Longitud>-58.382268</Longitud><Numero>0</Numero><Lugar>Tucumán entre Cerrito y 9 de Julio</Lugar><Piso></Piso><AnclajesTotales>11</AnclajesTotales><AnclajesDisponibles>11</AnclajesDisponibles></Estacion><Estacion><EstacionId>53</EstacionId><EstacionNombre>Ricardo Rojas</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.595389</Latitud><Longitud>-58.374469</Longitud><Numero>1031</Numero><Lugar>San Martin  entre Dr. Ricardo Rojas y Marcelo T. de Alvear</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>56</EstacionId><EstacionNombre>Plaza Palermo Viejo</EstacionNombre><BicicletaDisponibles>3</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.589416</Latitud><Longitud>-58.425143</Longitud><Numero>0</Numero><Lugar>Costa Rica y Malabia</Lugar><Piso></Piso><AnclajesTotales>16</AnclajesTotales><AnclajesDisponibles>13</AnclajesDisponibles></Estacion><Estacion><EstacionId>57</EstacionId><EstacionNombre>Belgrano</EstacionNombre><BicicletaDisponibles>8</BicicletaDisponibles><EstacionDisponible>NO</EstacionDisponible><Latitud>-34.613024</Latitud><Longitud>-58.370706</Longitud><Numero>482</Numero><Lugar>Balcarce entre Belgrano y Venezuela</Lugar><Piso></Piso><AnclajesTotales>16</AnclajesTotales><AnclajesDisponibles>8</AnclajesDisponibles></Estacion><Estacion><EstacionId>58</EstacionId><EstacionNombre>Ministro Carranza</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.575139</Latitud><Longitud>-58.434778</Longitud><Numero>5327</Numero><Lugar>SANTA FE Entre DORREGO Y AREVALO</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>60</EstacionId><EstacionNombre>25 de Mayo</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.601586</Latitud><Longitud>-58.371224</Longitud><Numero>527</Numero><Lugar>25 De Mayo entre Lavalle y Tucumán</Lugar><Piso></Piso><AnclajesTotales>18</AnclajesTotales><AnclajesDisponibles>18</AnclajesDisponibles></Estacion><Estacion><EstacionId>62</EstacionId><EstacionNombre>Córdoba</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.598506</Latitud><Longitud>-58.376938</Longitud><Numero>820</Numero><Lugar>Maipú entre Av. Córdoba y Paraguay</Lugar><Piso></Piso><AnclajesTotales>17</AnclajesTotales><AnclajesDisponibles>17</AnclajesDisponibles></Estacion><Estacion><EstacionId>64</EstacionId><EstacionNombre>Riobamba</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>NO</EstacionDisponible><Latitud>-34.594263</Latitud><Longitud>-58.394330</Longitud><Numero>0</Numero><Lugar>Riobamba entre Juncal y Arenales</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>19</AnclajesDisponibles></Estacion><Estacion><EstacionId>68</EstacionId><EstacionNombre>Rivarola</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.606681</Latitud><Longitud>-58.385455</Longitud><Numero>175</Numero><Lugar>Dr. Rodolfo Rivarola entre Tte. Gral. Juan Domingo Perón y Bartolomé Mitre</Lugar><Piso></Piso><AnclajesTotales>15</AnclajesTotales><AnclajesDisponibles>15</AnclajesDisponibles></Estacion><Estacion><EstacionId>76</EstacionId><EstacionNombre>Ayacucho</EstacionNombre><BicicletaDisponibles>0</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.607551</Latitud><Longitud>-58.394959</Longitud><Numero>0</Numero><Lugar>Ayacucho entre Perón J. D y Bartolomé Mitre</Lugar><Piso></Piso><AnclajesTotales>20</AnclajesTotales><AnclajesDisponibles>20</AnclajesDisponibles></Estacion><Estacion><EstacionId>94</EstacionId><EstacionNombre>Guzmán</EstacionNombre><BicicletaDisponibles>2</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.591811</Latitud><Longitud>-58.449442</Longitud><Numero>101</Numero><Lugar>GUZMAN Entre LEIVA Y ARENAL, CONCEPCION</Lugar><Piso></Piso><AnclajesTotales>28</AnclajesTotales><AnclajesDisponibles>26</AnclajesDisponibles></Estacion><Estacion><EstacionId>515</EstacionId><EstacionNombre>Emilio Mitre</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>SI</EstacionDisponible><Latitud>-34.588546</Latitud><Longitud>-58.397712</Longitud><Numero>2399</Numero><Lugar>Pacheco de Melo y Larrea</Lugar><Piso></Piso><AnclajesTotales>50</AnclajesTotales><AnclajesDisponibles>49</AnclajesDisponibles></Estacion><Estacion><EstacionId>521</EstacionId><EstacionNombre>Caseros</EstacionNombre><BicicletaDisponibles>1</BicicletaDisponibles><EstacionDisponible>NO</EstacionDisponible><Latitud>-34.638021</Latitud><Longitud>-58.410794</Longitud><Numero>0</Numero><Lugar>Av. Caseros entre Pepirí y Alma Fuerte</Lugar><Piso></Piso><AnclajesTotales>50</AnclajesTotales><AnclajesDisponibles>49</AnclajesDisponibles></Estacion></Estaciones><TiempoRespuesta>0,562 segundos</TiempoRespuesta></Bicicletas></BicicletasWSResult></BicicletasWSResponse></soap:Body></soap:Envelope>";
    }


    private JSONObject convertXmlToJson(String xml) {
        JSONObject jsonObj = null;
        try {
            jsonObj = XML.toJSONObject(xml);
        } catch (JSONException e) {
            Log.e("JSON exception", e.getMessage());
            e.printStackTrace();
        }
        return jsonObj;
    }



}
